<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMM 3 Inbound</title>
    <!-- Bootstrap CSS -->
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
    <div class="card bg-primary mb-3">
        <ul class="nav nav-pills">

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Pertukaran Mahasiswa Merdeka</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_out">PMM 1 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_2_out">PMM 2 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_out">PMM 3 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_out">PMM 4 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_in">PMM 1 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_in">PMM 3 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_in">PMM 4 Inbound</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Kampus Mengajar</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_1">KM 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_2">KM 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_3">KM 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_4">KM 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_5">KM 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_6">KM 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_7">KM 7</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_8">KM 8</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Magang dan Studi Independen Bersertifikat</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_1">MSIB 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_2">MSIB 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_3">MSIB 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_4">MSIB 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_5">MSIB 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_6">MSIB 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_7">MSIB 7</a></li>
              </ul>
            </li>
          </ul>
    </div>
    <div class="card">
        <div class="card-header">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="all-tab" data-bs-toggle="pill" data-bs-target="#all" type="button" role="tab">ALL</button>
                </li>
            </ul>
        </div>
        
        <div class="card-body">
            <!-- Tabs for Fakultas -->
            <div class="d-flex align-items-right gap-2 gap-lg-3">
                <h5 class="card-title">Data Pertukaran Mahasiswa Merdeka Inbound Angkatan 3</h5>
                <button id="download-btn" class="btn btn-primary">Download Excel</button>
            </div>
            <hr>
            <!-- Tab content for Fakultas -->
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="all" role="tabpanel">
                    <table id="all-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>NAMA</th>
                                <th>UNIVERSITAS ASAL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ETTI KURNIA</td>
                                <td>Universitas Ahmad Dahlan</td>
                            </tr>
                            <tr>
                                <td>MARY UNDAP LOVELIE BUDIONO</td>
                                <td>Universitas Internasional Batam</td>
                            </tr>
                            <tr>
                                <td>ELYSARI HUTAPEA</td>
                                <td>Universitas Islam Riau</td>
                            </tr>
                            <tr>
                                <td>SULASTRI BELEN</td>
                                <td>Universitas Lancang Kuning</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD SURYA ANGGARA</td>
                                <td>Universitas Muhammadiyah Semarang</td>
                            </tr>
                            <tr>
                                <td>PUTI ANDINI</td>
                                <td>Universitas Islam Riau</td>
                            </tr>
                            <tr>
                                <td>MARCELLO AHIMSA HAYAMAPUTRA</td>
                                <td>Universitas Mulawarman</td>
                            </tr>
                            <tr>
                                <td>ELDA DITA FELYSA BR TARIGAN</td>
                                <td>Universitas Sriwijaya</td>
                            </tr>
                            <tr>
                                <td>SITI AZZAHRO</td>
                                <td>Universitas Islam Bandung</td>
                            </tr>
                            <tr>
                                <td>ANISATUL MARUF`FA</td>
                                <td>Universitas 17 Agustus 1945 Surabaya</td>
                            </tr>
                            <tr>
                                <td>YULIANA PUTRI</td>
                                <td>Universitas Aisyiyah Yogyakarta</td>
                            </tr>
                            <tr>
                                <td>NIKERIA LUMBANTORUAN</td>
                                <td>Universitas Bengkulu</td>
                            </tr>
                            <tr>
                                <td>PANCA NUGRAHA</td>
                                <td>Universitas Dehasen Bengkulu</td>
                            </tr>
                            <tr>
                                <td>ERNA PARAMITHA</td>
                                <td>Universitas Jember</td>
                            </tr>
                            <tr>
                                <td>NADHIF FERDINANSYAH</td>
                                <td>Universitas Jenderal Soedirman</td>
                            </tr>
                            <tr>
                                <td>AZIZAH NUR AINI</td>
                                <td>Universitas Jenderal Soedirman</td>
                            </tr>
                            <tr>
                                <td>MAGFIRA JUANDA</td>
                                <td>Universitas Khairun</td>
                            </tr>
                            <tr>
                                <td>RISMA NOVITA SARI</td>
                                <td>Universitas Negeri Yogyakarta</td>
                            </tr>
                            <tr>
                                <td>DONDI IKRAR OKTAVIANNO</td>
                                <td>Universitas PGRI Semarang</td>
                            </tr>
                            <tr>
                                <td>AZRA HAKINA DANISWARA</td>
                                <td>Universitas Sarjanawiyata Tamansiswa</td>
                            </tr>
                            <tr>
                                <td>RAMBU DAY ANAMAHANG</td>
                                <td>Universitas Tribhuwana Tungga Dewi</td>
                            </tr>
                            <tr>
                                <td>NAILA LUNA AZ-ZAHRA</td>
                                <td>Universitas Muhammadiyah Kalimantan Timur</td>
                            </tr>
                            <tr>
                                <td>ROSITA BR SIANTUR</td>
                                <td>Institut Teknologi dan Bisnis Indonesia</td>
                            </tr>
                            <tr>
                                <td>TERESIA MARSAULINA SITIO</td>
                                <td>Universitas Bengkulu</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD YUSRIL BUSYRO</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>SHEVA ALVIANO KAWA</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>M. RYAN FADILLAH</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD ALI RIDLO</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>RIZKA ZALSABILAH SAMUDRA</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>KRISTIANA MARCH KUSUMA</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>ELFHIRA RENATA HERLAMBANG</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>MICHELLE GABRIELLA PAULINE</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>ROSIANA VERA</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>ANNISA DEWI CAHYA NIRWANA</td>
                                <td>Universitas Merdeka Malang</td>
                            </tr>
                            <tr>
                                <td>DONIUS NDRURU</td>
                                <td>Universitas HKBP Nommensen</td>
                            </tr>
                            <tr>
                                <td>JUANA KRISMELITA SARAGIH</td>
                                <td>Universitas Islam Riau</td>
                            </tr>
                            <tr>
                                <td>CHRISDAYANTI NAINGGOLAN</td>
                                <td>Universitas Jambi</td>
                            </tr>
                            <tr>
                                <td>LIYANTY LAIHASNI ROHMAN</td>
                                <td>Universitas Jambi</td>
                            </tr>
                            <tr>
                                <td>NURFITRIYANI</td>
                                <td>Universitas Jambi</td>
                            </tr>
                            <tr>
                                <td>AISHA ARYANING GUSTI</td>
                                <td>Universitas Muslim Nusantara Al-Washliyah</td>
                            </tr>
                            <tr>
                                <td>JUWITA PURNAMA SARI</td>
                                <td>Universitas Prima Indonesia</td>
                            </tr>
                            <tr>
                                <td>YUNITA SRI MALEM BARUS</td>
                                <td>Universitas Samudra</td>
                            </tr>
                            <tr>
                                <td>NOVI WULAN SARI</td>
                                <td>Universitas Samudra</td>
                            </tr>
                            <tr>
                                <td>LINDA AFRIYANI</td>
                                <td>Universitas Samudra</td>
                            </tr>
                            <tr>
                                <td>AUDY STIEFANNY</td>
                                <td>Universitas Sumatera Utara</td>
                            </tr>
                            <tr>
                                <td>KIBARDA</td>
                                <td>Universitas Syiah Kuala</td>
                            </tr>
                            <tr>
                                <td>HANUM ZAHROTUDDINIYAH</td>
                                <td>Institut Seni Budaya Indonesia Bandung</td>
                            </tr>
                            <tr>
                                <td>LUTHFI NABILAH AILEN</td>
                                <td>Universitas Jenderal Soedirman</td>
                            </tr>
                            <tr>
                                <td>DANDI KUSNAEDI</td>
                                <td>Universitas Majalengka</td>
                            </tr>
                            <tr>
                                <td>AYU RAHAYU</td>
                                <td>Universitas Pamulang</td>
                            </tr>
                            <tr>
                                <td>ADITYA RIZKI RAMADANI</td>
                                <td>Universitas Suryakancana</td>
                            </tr>
                            <tr>
                                <td>KURNIAWAN ARYA SAPUTRA</td>
                                <td>Universitas Teuku Umar</td>
                            </tr>
                            <tr>
                                <td>YULINDA D. HAKO</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>LISA FARIDA MILLUI</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>NADIA FEBILIA PANGA</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>BOBI SOPIAN WARSO</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>JEFRI BULAMBAE</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>FITRIA ANANDA SAPUTRI ONGE</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>FAHMIYANI H. LOUTO</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>SITI AMINAH LARAMA</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>GEDE PUTRA WINATA</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                            <tr>
                                <td>PRATIWI MUCHLIS</td>
                                <td>Universitas Tompotika Luwuk Banggai</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
      </div>

    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    $(document).ready(function() {
        // Apply DataTables to all tables
        $('table').DataTable();
    });
</script>
<script>
    // Function to download table data as Excel
    function downloadTableAsExcel(tableID) {
        // Get DataTable instance using the table ID
        var table = $('#' + tableID).DataTable();  // Correctly refer to tableID
        if (table.data().length === 0) {
            alert("Tabel kosong, tidak ada data untuk diunduh.");
            return;  // Stop execution if table is empty
        }
        var data = [];

        // Get table headers
        var headers = [];
        $('#' + tableID + ' thead th').each(function () {
            headers.push($(this).text());
        });
        data.push(headers);  // Add headers to the data array

        // Get all table data (including non-visible rows due to pagination)
        table.rows().every(function () {
            var rowData = this.data();
            data.push(rowData);  // Add row data to the data array
        });

        // Create new workbook and worksheet
        var workbook = XLSX.utils.book_new();
        var worksheet = XLSX.utils.aoa_to_sheet(data);  // Create worksheet from array of arrays (aoa)

        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

        // Export workbook to XLSX file and trigger download
        XLSX.writeFile(workbook, 'Data Peserta MBKM.xlsx');
    }

    // Function to get the active tab and download the corresponding table
    document.getElementById("download-btn").addEventListener("click", function () {
        const activeTab = document.querySelector(".tab-pane.active");

        if (activeTab) {
            // Find the table inside the active tab
            const table = activeTab.querySelector("table");
            if (table) {
                const tableID = table.getAttribute("id");
                downloadTableAsExcel(tableID);
            } else {
                alert("Tidak ada tabel di tab yang aktif.");
            }
        } else {
            alert("Tidak ada tab yang aktif.");
        }
    });
</script>

</body>
</html>
