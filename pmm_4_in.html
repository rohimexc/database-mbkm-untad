<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMM 4 Inbound</title>
    <!-- Bootstrap CSS -->
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
    <div class="card bg-primary mb-3">
        <ul class="nav nav-pills">

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Pertukaran Mahasiswa Merdeka</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_out">PMM 1 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_2_out">PMM 2 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_out">PMM 3 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_out">PMM 4 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_in">PMM 1 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_in">PMM 3 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_in">PMM 4 Inbound</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Kampus Mengajar</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_1">KM 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_2">KM 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_3">KM 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_4">KM 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_5">KM 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_6">KM 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_7">KM 7</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_8">KM 8</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Magang dan Studi Independen Bersertifikat</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_1">MSIB 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_2">MSIB 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_3">MSIB 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_4">MSIB 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_5">MSIB 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_6">MSIB 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_7">MSIB 7</a></li>
              </ul>
            </li>
          </ul>
    </div>
    <div class="card">
        <div class="card-header">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="all-tab" data-bs-toggle="pill" data-bs-target="#all" type="button" role="tab">ALL</button>
                </li>
            </ul>
        </div>
        
        <div class="card-body">
            <!-- Tabs for Fakultas -->
            <div class="d-flex align-items-right gap-2 gap-lg-3">
                <h5 class="card-title">Data Pertukaran Mahasiswa Merdeka Inbound Angkatan 4</h5>
                <button id="download-btn" class="btn btn-primary">Download Excel</button>
                <button type="button" id="count-result" class="btn btn-light position-relative">
                    Total Peserta Tingkat Universitas
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="total-count">
                        100
                    </span>
                </button>
            </div>
            <hr>
            <!-- Tab content for Fakultas -->
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="all" role="tabpanel">
                    <table id="all-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>NAMA</th>
                                <th>UNIVERSITAS ASAL</th>
                                <th>PROGRAM STUDI</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ANGEL KAROLINA HALAWA</td>
                                <td>Institut Kesehatan Sumatera Utara</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>OMIKARLINA LASE</td>
                                <td>Institut Kesehatan Sumatera Utara</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>NOVITA</td>
                                <td>Sekolah Tinggi Ilmu Hukum Manokwari</td>
                                <td>S1 Ilmu Hukum</td>
                            </tr>
                            <tr>
                                <td>ANITA YUHANDINI</td>
                                <td>Universitas Aisyah Pringsewu</td>
                                <td>S1 Farmasi</td>
                            </tr>
                            <tr>
                                <td>SUMIYATI</td>
                                <td>Universitas Aisyah Pringsewu</td>
                                <td>S1 Farmasi</td>
                            </tr>
                            <tr>
                                <td>MELIA SHAKILA PURNAMA</td>
                                <td>Universitas Aisyiyah Yogyakarta</td>
                                <td>S1 Gizi</td>
                            </tr>
                            <tr>
                                <td>SITI FATIMAH AZ ZAHROH</td>
                                <td>Universitas Aisyiyah Yogyakarta</td>
                                <td>S1 Gizi</td>
                            </tr>
                            <tr>
                                <td>TRI JULIYANTI</td>
                                <td>Universitas Aisyiyah Yogyakarta</td>
                                <td>S1 Gizi</td>
                            </tr>
                            <tr>
                                <td>ANNA KHAIRUNNISSA</td>
                                <td>Universitas Bengkulu</td>
                                <td>S1 Ekonomi Pembangunan</td>
                            </tr>
                            <tr>
                                <td>AQBIL DWI ATMA</td>
                                <td>Universitas Bengkulu</td>
                                <td>S1 Ekonomi Pembangunan</td>
                            </tr>
                            <tr>
                                <td>DINDA ZAHARA</td>
                                <td>Universitas Bengkulu</td>
                                <td>S1 Ekonomi Pembangunan</td>
                            </tr>
                            <tr>
                                <td>FITRI AGUSTINA</td>
                                <td>Universitas Bengkulu</td>
                                <td>S1 Ekonomi Pembangunan</td>
                            </tr>
                            <tr>
                                <td>SALMAN ALFARISI</td>
                                <td>Universitas Bengkulu</td>
                                <td>S1 Bimbingan dan Konseling</td>
                            </tr>
                            <tr>
                                <td>IRKHAMNA FITRIARRUM</td>
                                <td>Universitas Hasyim Asy&#39;ari Tebuireng Jombang</td>
                                <td>S1 Pendidikan Bahasa Inggris</td>
                            </tr>
                            <tr>
                                <td>ENJELS ELYANA BATUARA</td>
                                <td>Universitas Jambi</td>
                                <td>S1 Teknik Geofisika</td>
                            </tr>
                            <tr>
                                <td>JESICA YOLANDA PUTRANA MANALU</td>
                                <td>Universitas Jambi</td>
                                <td>S1 Ilmu Hukum</td>
                            </tr>
                            <tr>
                                <td>RUSMANTI ADELINA BANCIN</td>
                                <td>Universitas Jambi</td>
                                <td>S1 Teknik Geofisika</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD RIJALUL FIKRI</td>
                                <td>Universitas Jenderal Soedirman</td>
                                <td>S1 Peternakan</td>
                            </tr>
                            <tr>
                                <td>ADINDA PUTRI PURNAMA SARI</td>
                                <td>Universitas Lampung</td>
                                <td>S1 Pendidikan Fisika</td>
                            </tr>
                            <tr>
                                <td>RUFINA PRAMUDITA</td>
                                <td>Universitas Lampung</td>
                                <td>S1 Ilmu Hukum</td>
                            </tr>
                            <tr>
                                <td>YULI YANI PERMATA SAKTI</td>
                                <td>Universitas Lampung</td>
                                <td>S1 Pendidikan Fisika</td>
                            </tr>
                            <tr>
                                <td>ADIRA SINGGIH WIDANTO</td>
                                <td>Universitas Malikussaleh</td>
                                <td>S1 Agribisnis</td>
                            </tr>
                            <tr>
                                <td>NABILA BULQIS S PAPUDE</td>
                                <td>Universitas Malikussaleh</td>
                                <td>S1 Sosiologi</td>
                            </tr>
                            <tr>
                                <td>AURA URANIA MRITASAMJIWANI</td>
                                <td>Universitas Mataram</td>
                                <td>S1 Pendidikan Guru Sekolah Dasar</td>
                            </tr>
                            <tr>
                                <td>GALANG IJTIHAD</td>
                                <td>Universitas Mataram</td>
                                <td>S1 Pendidikan Guru Sekolah Dasar</td>
                            </tr>
                            <tr>
                                <td>REFIKA ARDANI</td>
                                <td>Universitas Mataram</td>
                                <td>S1 Pendidikan Guru Sekolah Dasar</td>
                            </tr>
                            <tr>
                                <td>YAYU OKTAVIANA</td>
                                <td>Universitas Mataram</td>
                                <td>S1 Kimia</td>
                            </tr>
                            <tr>
                                <td>KHANSA NABILA</td>
                                <td>Universitas Muhammadiyah Aceh</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>NURUL ANNISA</td>
                                <td>Universitas Muhammadiyah Aceh</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>KERIN GUSVIRA ANNISA</td>
                                <td>Universitas Muhammadiyah Bengkulu</td>
                                <td>S1 Ilmu Komunikasi</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD ZACKY. A</td>
                                <td>Universitas Muhammadiyah Semarang</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>SITI MASROKHATUN NIDA</td>
                                <td>Universitas Nahdlatul Ulama Al Ghazali Cilacap</td>
                                <td>S1 Bimbingan Dan Konseling</td>
                            </tr>
                            <tr>
                                <td>ANISA NUR AFIFAH</td>
                                <td>Universitas Nahdlatul Ulama Purwokerto</td>
                                <td>S1 Administrasi Publik</td>
                            </tr>
                            <tr>
                                <td>PUTRI SOFWATUL LAELI</td>
                                <td>Universitas Nahdlatul Ulama Purwokerto</td>
                                <td>S1 Administrasi Publik</td>
                            </tr>
                            <tr>
                                <td>QUROTUL &#39;AENI</td>
                                <td>Universitas Nahdlatul Ulama Purwokerto</td>
                                <td>S1 Administrasi Publik</td>
                            </tr>
                            <tr>
                                <td>SALSANADHIFA ELITA PERMATA BUDIYANTO</td>
                                <td>Universitas Nahdlatul Ulama Purwokerto</td>
                                <td>S1 Administrasi Publik</td>
                            </tr>
                            <tr>
                                <td>FILZAH IRSHADI</td>
                                <td>Universitas Negeri Medan</td>
                                <td>S1 Pendidikan Pancasila Dan Kewarganegaraan</td>
                            </tr>
                            <tr>
                                <td>HILKIA NATASYA BR GINTING</td>
                                <td>Universitas Negeri Medan</td>
                                <td>S1 Ilmu Ekonomi</td>
                            </tr>
                            <tr>
                                <td>MELINDA SARAGI</td>
                                <td>Universitas Negeri Medan</td>
                                <td>S1 Pendidikan Geografi</td>
                            </tr>
                            <tr>
                                <td>NOVITA HOTMA ULI SITANGGANG</td>
                                <td>Universitas Negeri Medan</td>
                                <td>S1 Ilmu Ekonomi</td>
                            </tr>
                            <tr>
                                <td>RELLI ANISMA HUTABALIAN</td>
                                <td>Universitas Negeri Medan</td>
                                <td>S1 Ilmu Ekonomi</td>
                            </tr>
                            <tr>
                                <td>TINA YULINDA</td>
                                <td>Universitas Nusa Putra</td>
                                <td>S1 Hukum</td>
                            </tr>
                            <tr>
                                <td>LIZA TRI PURNAMASARI</td>
                                <td>Universitas Pamulang</td>
                                <td>S1 Akuntansi</td>
                            </tr>
                            <tr>
                                <td>GALIH YUNIAR PRAKOSO</td>
                                <td>Universitas Pendidikan Ganesha</td>
                                <td>S1 Sistem Informasi</td>
                            </tr>
                            <tr>
                                <td>NABILA AULIA AZIZAH</td>
                                <td>Universitas Pendidikan Ganesha</td>
                                <td>S1 Sistem Informasi</td>
                            </tr>
                            <tr>
                                <td>SYARIFUDIN ABDULLAH</td>
                                <td>Universitas Pendidikan Ganesha</td>
                                <td>S1 Sistem Informasi</td>
                            </tr>
                            <tr>
                                <td>YULIANI FOFID</td>
                                <td>Universitas Pendidikan Muhammadiyah Sorong</td>
                                <td>S1 Pendidikan Pancasila dan Kewarganegaraan</td>
                            </tr>
                            <tr>
                                <td>AZZAH INAS DZAHABIYYAH</td>
                                <td>Universitas PGRI Ronggolawe</td>
                                <td>S1 Matematika</td>
                            </tr>
                            <tr>
                                <td>ASMARITA</td>
                                <td>Universitas Riau</td>
                                <td>S1 Pendidikan Sejarah</td>
                            </tr>
                            <tr>
                                <td>NANDA TASYA</td>
                                <td>Universitas Riau</td>
                                <td>S1 Pendidikan Guru Pendidikan Anak Usia Dini</td>
                            </tr>
                            <tr>
                                <td>NASARINA YOLITA DINA LEKI</td>
                                <td>Universitas Sains dan Teknologi Komputer</td>
                                <td>S1 Manajemen</td>
                            </tr>
                            <tr>
                                <td>HARDIANT TERRENT ZETTA MAHENDRA</td>
                                <td>Universitas Sebelas Maret</td>
                                <td>S1 Pendidikan Geografi</td>
                            </tr>
                            <tr>
                                <td>LAMHOT RIZKY ANSYAH SIDabutar</td>
                                <td>Universitas Simalungun</td>
                                <td>S1 Kehutanan</td>
                            </tr>
                            <tr>
                                <td>ASTRID FATIKHASARI</td>
                                <td>Universitas Singaperbangsa Karawang</td>
                                <td>S1 Ilmu Hukum</td>
                            </tr>
                            <tr>
                                <td>R. RAFI RIZQULLOH</td>
                                <td>Universitas Singaperbangsa Karawang</td>
                                <td>S1 Agroteknologi</td>
                            </tr>
                            <tr>
                                <td>TRISTINA ADILIA PUTRI MAHARANI</td>
                                <td>Universitas Singaperbangsa Karawang</td>
                                <td>S1 Ilmu Hukum</td>
                            </tr>
                            <tr>
                                <td>IMELDA INTAN PERMATA SARI</td>
                                <td>Universitas Sriwijaya</td>
                                <td>S1 Kesehatan Masyarakat</td>
                            </tr>
                            <tr>
                                <td>RIZQY PRAYOGA</td>
                                <td>Universitas Sriwijaya</td>
                                <td>S1 Pendidikan Sejarah</td>
                            </tr>
                            <tr>
                                <td>NABILA YULIA SINTA</td>
                                <td>Universitas Sultan Ageng Tirtayasa</td>
                                <td>S1 Agroekoteknologi</td>
                            </tr>
                            <tr>
                                <td>NAUFAL MARWAN SAPEI</td>
                                <td>Universitas Sultan Ageng Tirtayasa</td>
                                <td>S1 Agroekoteknologi</td>
                            </tr>
                            <tr>
                                <td>MUTIA SELVI SYAFIRA</td>
                                <td>Universitas Syiah Kuala</td>
                                <td>S1 Pendidikan Pancasila Dan Kewarganegaraan</td>
                            </tr>
                            <tr>
                                <td>SARWIDAD FIVAPRILA</td>
                                <td>Universitas Tanjungpura</td>
                                <td>S1 Sistem Informasi</td>
                            </tr>
                            <tr>
                                <td>ELLIA DEBBY LEONNY PUTRI SISWANTORO</td>
                                <td>Universitas Tidar</td>
                                <td>S1 Akuakultur</td>
                            </tr>
                            <tr>
                                <td>NURUL HASANAH</td>
                                <td>Universitas Tridinanti</td>
                                <td>S1 Manajemen</td>
                            </tr>
                            <tr>
                                <td>ILLIYA ROSIDA</td>
                                <td>Universitas Trunojoyo</td>
                                <td>S1 Teknik Informatika</td>
                            </tr>
                            <tr>
                                <td>JHON FILIUS GULTOM</td>
                                <td>Universitas Trunojoyo</td>
                                <td>S1 Teknik Informatika</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
      </div>

    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    $(document).ready(function() {
        // Apply DataTables to all tables
        $('table').DataTable();
    });
</script>
<script>
    // Function to download table data as Excel
    function downloadTableAsExcel(tableID) {
        // Get DataTable instance using the table ID
        var table = $('#' + tableID).DataTable();  // Correctly refer to tableID
        if (table.data().length === 0) {
            alert("Tabel kosong, tidak ada data untuk diunduh.");
            return;  // Stop execution if table is empty
        }
        var data = [];

        // Get table headers
        var headers = [];
        $('#' + tableID + ' thead th').each(function () {
            headers.push($(this).text());
        });
        data.push(headers);  // Add headers to the data array

        // Get all table data (including non-visible rows due to pagination)
        table.rows().every(function () {
            var rowData = this.data();
            data.push(rowData);  // Add row data to the data array
        });

        // Create new workbook and worksheet
        var workbook = XLSX.utils.book_new();
        var worksheet = XLSX.utils.aoa_to_sheet(data);  // Create worksheet from array of arrays (aoa)

        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

        // Export workbook to XLSX file and trigger download
        XLSX.writeFile(workbook, 'Data Peserta MBKM.xlsx');
    }

    // Function to get the active tab and download the corresponding table
    document.getElementById("download-btn").addEventListener("click", function () {
        const activeTab = document.querySelector(".tab-pane.active");

        if (activeTab) {
            // Find the table inside the active tab
            const table = activeTab.querySelector("table");
            if (table) {
                const tableID = table.getAttribute("id");
                downloadTableAsExcel(tableID);
            } else {
                alert("Tidak ada tabel di tab yang aktif.");
            }
        } else {
            alert("Tidak ada tab yang aktif.");
        }
    });
</script>
<script>
    // Array untuk menyimpan ID tabel
    const tableIds = [
        'all-table'
    ];

    // Fungsi untuk menghitung total baris di semua tabel
    function countTotalRows() {
        let totalRows = 0;
        tableIds.forEach(id => {
            const table = document.getElementById(id);
            if (table) {
                const rowCount = table.querySelectorAll('tbody tr').length;
                totalRows += rowCount;
            }
        });
        return totalRows;
    }

    // Ganti angka pada badge dengan hasil count
    function updateTotalCount() {
        const totalRows = countTotalRows();
        const totalCountSpan = document.getElementById('total-count');
        totalCountSpan.textContent = totalRows;
    }

    // Panggil fungsi untuk update total count saat halaman dimuat
    document.addEventListener('DOMContentLoaded', updateTotalCount);
</script>
</body>
</html>
