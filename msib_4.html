<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSIB 4</title>
    <!-- Bootstrap CSS -->
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
    <div class="card bg-primary mb-3">
        <ul class="nav nav-pills">

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Pertukaran Mahasiswa Merdeka</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_out">PMM 1 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_2_out">PMM 2 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_out">PMM 3 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_out">PMM 4 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_in">PMM 1 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_in">PMM 3 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_in">PMM 4 Inbound</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Kampus Mengajar</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_1">KM 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_2">KM 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_3">KM 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_4">KM 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_5">KM 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_6">KM 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_7">KM 7</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_8">KM 8</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Magang dan Studi Independen Bersertifikat</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_1">MSIB 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_2">MSIB 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_3">MSIB 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_4">MSIB 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_5">MSIB 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_6">MSIB 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_7">MSIB 7</a></li>
              </ul>
            </li>
          </ul>
    </div>
    <div class="card">
        <div class="card-header">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="fkip-tab" data-bs-toggle="pill" data-bs-target="#fkip" type="button" role="tab">FKIP</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fisip-tab" data-bs-toggle="pill" data-bs-target="#fisip" type="button" role="tab">FISIP</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="feb-tab" data-bs-toggle="pill" data-bs-target="#feb" type="button" role="tab">FEB</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fh-tab" data-bs-toggle="pill" data-bs-target="#fh" type="button" role="tab">FH</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="faperta-tab" data-bs-toggle="pill" data-bs-target="#faperta" type="button" role="tab">FAPERTA</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fatek-tab" data-bs-toggle="pill" data-bs-target="#fatek" type="button" role="tab">FATEK</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fmipa-tab" data-bs-toggle="pill" data-bs-target="#fmipa" type="button" role="tab">FMIPA</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fahut-tab" data-bs-toggle="pill" data-bs-target="#fahut" type="button" role="tab">FAHUT</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fapetkan-tab" data-bs-toggle="pill" data-bs-target="#fapetkan" type="button" role="tab">FAPETKAN</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fkm-tab" data-bs-toggle="pill" data-bs-target="#fkm" type="button" role="tab">FKM</button>
                </li>
            </ul>
        </div>
        
        <div class="card-body">
            <!-- Tabs for Fakultas -->
            <div class="d-flex align-items-right gap-2 gap-lg-3">
                <h5 class="card-title">Data Magang dan Studi Independen Bersertifikat Batch 4</h5>
                <button id="download-btn" class="btn btn-primary">Download Excel</button>
            </div>
            <hr>
            <!-- Tab content for Fakultas -->
            <div class="tab-content" id="pills-tabContent">
                <!-- FKIP -->
                <div class="tab-pane fade show active" id="fkip" role="tabpanel">
                    <table id="fkip-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PUTRI MAHARANI DWI RARASATI</td>
                                <td>A40120173</td>
                                <td>Pendidikan Guru Sekolah Dasar</td>
                                <td>PT Ruang Raya Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FISIP -->
                <div class="tab-pane fade" id="fisip" role="tabpanel">
                    <table id="fisip-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Afrianti Rukmana Sunuh</td>
                                <td>B50120002</td>
                                <td>Ilmu Komunikasi</td>
                                <td>PT Midi Utama Indonesia Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>MOH.AQBAR</td>
                                <td>B30120077</td>
                                <td>Antropologi</td>
                                <td>PT. Trisakti Pilar Persada</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Moh Rahmat</td>
                                <td>B50119176</td>
                                <td>Ilmu Komunikasi</td>
                                <td>PT. Garuda Cyber Indonesia</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Selviana</td>
                                <td>B50120120</td>
                                <td>Ilmu Komunikasi</td>
                                <td>PT Midi Utama Indonesia Tbk</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FEB -->
                <div class="tab-pane fade" id="feb" role="tabpanel">
                    <table id="feb-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ANDIKA PUTRA L PEAGO</td>
                                <td>C10119056</td>
                                <td>Ekonomi dan Pembangunan</td>
                                <td>Koperasi Produsen Wirausaha Unggul Bersama Indonesia</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Nurawaliyah Sania Rezky Putri</td>
                                <td>C20118322</td>
                                <td>Manajemen</td>
                                <td>PT United Tractors Tbk</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FH -->
                <div class="tab-pane fade" id="fh" role="tabpanel">
                    <table id="fh-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                           
                        </tbody>
                    </table>
                </div>

                <!-- Fakultas lainnya bisa ditambahkan sesuai kebutuhan -->
                <div class="tab-pane fade" id="faperta" role="tabpanel">
                    <table id="faperta-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>AGUS SUSILO SUHARTO</td>
                                <td>E32120236</td>
                                <td>Agribisnis</td>
                                <td>PT JAPFA COMFEED INDONESIA Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>IIS PARAMITA</td>
                                <td>E32120251</td>
                                <td>Agribisnis</td>
                                <td>PT JAPFA COMFEED INDONESIA Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>RINDIYANI STYANINGRUM</td>
                                <td>E32120084</td>
                                <td>Agribisnis</td>
                                <td>PT JAPFA COMFEED INDONESIA Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>SRI BUDI NINGSIH</td>
                                <td>E32119174</td>
                                <td>Agribisnis</td>
                                <td>PT JAPFA COMFEED INDONESIA Tbk</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FATEK -->
                <div class="tab-pane fade" id="fatek" role="tabpanel">
                    <table id="fatek-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>I Made Reyvinno Dirga Narke</td>
                                <td>F52120044</td>
                                <td>Sistem Informasi</td>
                                <td>Bank Indonesia</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Mohamad Fadil A. Hamu</td>
                                <td>F23120022</td>
                                <td>Perencanaan Wilayah dan Kota</td>
                                <td>Direktorat Jenderal Tata Ruang, Kementerian Agraria dan Tata Ruang/Badan Pertanahan Nasional</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>MOH RIFKI</td>
                                <td>F52120055</td>
                                <td>Sistem Informasi</td>
                                <td>PT Cybers Global Indonesia</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Muhamad Putra Satria</td>
                                <td>F55120009</td>
                                <td>Teknik Informatika</td>
                                <td>PT MALEO EDUKASI TEKNOLOGI</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>RAHMAD GUNAWAN</td>
                                <td>F23120038</td>
                                <td>Perencanaan Wilayah dan Kota</td>
                                <td>Direktorat Jenderal Tata Ruang, Kementerian Agraria dan Tata Ruang/Badan Pertanahan Nasional</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>RISKA AMALIA AMANDA</td>
                                <td>F23120017</td>
                                <td>Perencanaan Wilayah dan Kota</td>
                                <td>Direktorat Jenderal Tata Ruang, Kementerian Agraria dan Tata Ruang/Badan Pertanahan Nasional</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>SITI JAMILAH TANGGI</td>
                                <td>F23120051</td>
                                <td>Perencanaan Wilayah dan Kota</td>
                                <td>Direktorat Jenderal Tata Ruang, Kementerian Agraria dan Tata Ruang/Badan Pertanahan Nasional</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Zahra Ziam R. Mukarram</td>
                                <td>F23120041</td>
                                <td>Perencanaan Wilayah dan Kota</td>
                                <td>Direktorat Jenderal Tata Ruang, Kementerian Agraria dan Tata Ruang/Badan Pertanahan Nasional</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Andika Dwiyanto</td>
                                <td>F55120119</td>
                                <td>Teknik Informatika</td>
                                <td>PT Talenta Sinergi Group</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>ARIEF RAHMAN HAKIM</td>
                                <td>F55120071</td>
                                <td>Teknik Informatika</td>
                                <td>PT Presentologics</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>Isma</td>
                                <td>F55120056</td>
                                <td>Teknik Informatika</td>
                                <td>PT Hacktivate Teknologi Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>M. FAHRIL</td>
                                <td>F55120033</td>
                                <td>Teknik Informatika</td>
                                <td>PT Presentologics</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MOH. FAHMI</td>
                                <td>F55120077</td>
                                <td>Teknik Informatika</td>
                                <td>PT Ruang Raya Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD DWIKI BAYU ARISTO</td>
                                <td>F44120024</td>
                                <td>Teknik Elektro</td>
                                <td>PT Orbit Ventura Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD FAIZ FAUZAN</td>
                                <td>F44120028</td>
                                <td>Teknik Elektro</td>
                                <td>PT Orbit Ventura Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MUHAMMAD SYAHPUTRA MAULANA</td>
                                <td>F55120055</td>
                                <td>Teknik Informatika</td>
                                <td>PT Tata Informasi Asia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>NILUH PUTU APRILLIA PUSPITADEWI S. P.</td>
                                <td>F55119023</td>
                                <td>Teknik Informatika</td>
                                <td>PT Dicoding Akademi Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>Nuri Iman Sari</td>
                                <td>F55120045</td>
                                <td>Teknik Informatika</td>
                                <td>PT Orbit Ventura Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>RENALDA SALWA SIVA</td>
                                <td>F55120042</td>
                                <td>Teknik Informatika</td>
                                <td>PT Ozami Inti Sinergi</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FMIPA -->
                <div class="tab-pane fade" id="fmipa" role="tabpanel">
                    <table id="fmipa-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>DJELIYANA TALABA</td>
                                <td>G20120006</td>
                                <td>Matematika</td>
                                <td>PT United Tractors Tbk</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FAHUT -->
                <div class="tab-pane fade" id="fahut" role="tabpanel">
                    <table id="fahut-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </div>

                <!-- FAPETKAN -->
                <div class="tab-pane fade" id="fapetkan" role="tabpanel">
                    <table id="fapetkan-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </div>

                <!-- FKM -->
                <div class="tab-pane fade" id="fkm" role="tabpanel">
                    <table id="fkm-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>

    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    $(document).ready(function() {
        // Apply DataTables to all tables
        $('table').DataTable();
    });
</script>
<script>
    // Function to download table data as Excel
    function downloadTableAsExcel(tableID) {
        // Get DataTable instance using the table ID
        var table = $('#' + tableID).DataTable();  // Correctly refer to tableID
        if (table.data().length === 0) {
            alert("Tabel kosong, tidak ada data untuk diunduh.");
            return;  // Stop execution if table is empty
        }
        var data = [];

        // Get table headers
        var headers = [];
        $('#' + tableID + ' thead th').each(function () {
            headers.push($(this).text());
        });
        data.push(headers);  // Add headers to the data array

        // Get all table data (including non-visible rows due to pagination)
        table.rows().every(function () {
            var rowData = this.data();
            data.push(rowData);  // Add row data to the data array
        });

        // Create new workbook and worksheet
        var workbook = XLSX.utils.book_new();
        var worksheet = XLSX.utils.aoa_to_sheet(data);  // Create worksheet from array of arrays (aoa)

        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

        // Export workbook to XLSX file and trigger download
        XLSX.writeFile(workbook, 'Data Peserta MBKM.xlsx');
    }

    // Function to get the active tab and download the corresponding table
    document.getElementById("download-btn").addEventListener("click", function () {
        const activeTab = document.querySelector(".tab-pane.active");

        if (activeTab) {
            // Find the table inside the active tab
            const table = activeTab.querySelector("table");
            if (table) {
                const tableID = table.getAttribute("id");
                downloadTableAsExcel(tableID);
            } else {
                alert("Tidak ada tabel di tab yang aktif.");
            }
        } else {
            alert("Tidak ada tab yang aktif.");
        }
    });
</script>

</body>
</html>
