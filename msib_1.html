<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSIB 1</title>
    <!-- Bootstrap CSS -->
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
    <div class="card bg-primary mb-3">
        <ul class="nav nav-pills">

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Pertukaran Mahasiswa Merdeka</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_out">PMM 1 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_2_out">PMM 2 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_out">PMM 3 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_out">PMM 4 Outbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_1_in">PMM 1 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_3_in">PMM 3 Inbound</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/pmm_4_in">PMM 4 Inbound</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Kampus Mengajar</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_1">KM 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_2">KM 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_3">KM 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_4">KM 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_5">KM 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_6">KM 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_7">KM 7</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/km_8">KM 8</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Magang dan Studi Independen Bersertifikat</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_1">MSIB 1</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_2">MSIB 2</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_3">MSIB 3</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_4">MSIB 4</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_5">MSIB 5</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_6">MSIB 6</a></li>
                <li><a class="dropdown-item" href="/database-mbkm-untad/msib_7">MSIB 7</a></li>
              </ul>
            </li>
          </ul>
    </div>
    <div class="card">
        <div class="card-header">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="fkip-tab" data-bs-toggle="pill" data-bs-target="#fkip" type="button" role="tab">FKIP</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fisip-tab" data-bs-toggle="pill" data-bs-target="#fisip" type="button" role="tab">FISIP</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="feb-tab" data-bs-toggle="pill" data-bs-target="#feb" type="button" role="tab">FEB</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fh-tab" data-bs-toggle="pill" data-bs-target="#fh" type="button" role="tab">FH</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="faperta-tab" data-bs-toggle="pill" data-bs-target="#faperta" type="button" role="tab">FAPERTA</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fatek-tab" data-bs-toggle="pill" data-bs-target="#fatek" type="button" role="tab">FATEK</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fmipa-tab" data-bs-toggle="pill" data-bs-target="#fmipa" type="button" role="tab">FMIPA</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fahut-tab" data-bs-toggle="pill" data-bs-target="#fahut" type="button" role="tab">FAHUT</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fapetkan-tab" data-bs-toggle="pill" data-bs-target="#fapetkan" type="button" role="tab">FAPETKAN</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="fkm-tab" data-bs-toggle="pill" data-bs-target="#fkm" type="button" role="tab">FKM</button>
                </li>
            </ul>
        </div>
        
        <div class="card-body">
            <!-- Tabs for Fakultas -->
            <div class="d-flex align-items-right gap-2 gap-lg-3">
                <h5 class="card-title">Data Magang dan Studi Independen Bersertifikat Batch 1</h5>
                <button id="download-btn" class="btn btn-primary">Download Excel</button>
            </div>
            <hr>
            <!-- Tab content for Fakultas -->
            <div class="tab-content" id="pills-tabContent">
                <!-- FKIP -->
                <div class="tab-pane fade show active" id="fkip" role="tabpanel">
                    <table  id="fkip-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>MOHAMAD SODIK</td>
                                <td>A24118012</td>
                                <td>Pendidikan Fisika</td>
                                <td></td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FISIP -->
                <div class="tab-pane fade" id="fisip" role="tabpanel">
                    <table id="fisip-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ryan Hidayatullah Tafsandji</td>
                                <td>C10119024</td>
                                <td>Ekonomi dan Pembangunan</td>
                                <td>Sekretariat Jenderal Dewan Perwakilan Rakyat Republik Indonesia</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>ARYO SUTIO NUGROHO</td>
                                <td>C20118248</td>
                                <td>Manajemen</td>
                                <td>Yayasan Sekolah Ekspor Nasional</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>FERDIAN PRAYOGA</td>
                                <td>C20118294</td>
                                <td>Manajemen</td>
                                <td>Yayasan Sekolah Ekspor Nasional</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>DIKI WAHYUDI</td>
                                <td>C20118299</td>
                                <td>Manajemen</td>
                                <td>Yayasan Sekolah Ekspor Nasional</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>NUR FADILAH AHMAD</td>
                                <td>C30019001</td>
                                <td>Akuntansi Sektor Publik</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FEB -->
                <div class="tab-pane fade" id="feb" role="tabpanel">
                    <table id="feb-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </div>

                <!-- FH -->
                <div class="tab-pane fade" id="fh" role="tabpanel">
                    <table id="fh-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Wilson Sastra</td>
                                <td>D10118524</td>
                                <td>Ilmu Hukum</td>
                                <td>PT Hacktivate Teknologi Indonesia</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Fakultas lainnya bisa ditambahkan sesuai kebutuhan -->
                <div class="tab-pane fade" id="faperta" role="tabpanel">
                    <table id="faperta-table" class="table table-striped table-bordered"> 
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Progrma</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>OMAR SYARIF H.</td>
                                <td>E28119471</td>
                                <td>Agroteknologi</td>
                                <td>Yayasan Sekolah Ekspor Nasional</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FATEK -->
                <div class="tab-pane fade" id="fatek" role="tabpanel">
                    <table id="fatek-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Abd. Rahman Sholeh</td>
                                <td>F44119056</td>
                                <td>Teknik Elektro</td>
                                <td>PT Orbit Ventura Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>AFIFUDDIN</td>
                                <td>F55118053</td>
                                <td>Teknik Informatika</td>
                                <td>PT Telkom Indonesia (Persero) Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>EKO PRASETYO</td>
                                <td>F55118063</td>
                                <td>Teknik Informatika</td>
                                <td>PT Mitra Semeru Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MOHAMMAD ARAFAT MAKU</td>
                                <td>F55118213</td>
                                <td>Teknik Informatika</td>
                                <td>CV Lumintu Logic</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>AKWAN MAROSO</td>
                                <td>F55119044</td>
                                <td>Teknik Informatika</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>Ryan Adi Putra</td>
                                <td>F55119059</td>
                                <td>Teknik Informatika</td>
                                <td>PT Global Intra Talenta</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Andi Gita Magfira Pratiwi Putri</td>
                                <td>F55119083</td>
                                <td>Teknik Informatika</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FMIPA -->
                <div class="tab-pane fade" id="fmipa" role="tabpanel">
                    <table id="fmipa-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Abd. Rahman Sholeh</td>
                                <td>F44119056</td>
                                <td>Teknik Elektro</td>
                                <td>PT Orbit Ventura Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>AFIFUDDIN</td>
                                <td>F55118053</td>
                                <td>Teknik Informatika</td>
                                <td>PT Telkom Indonesia (Persero) Tbk</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>EKO PRASETYO</td>
                                <td>F55118063</td>
                                <td>Teknik Informatika</td>
                                <td>PT Mitra Semeru Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>MOHAMMAD ARAFAT MAKU</td>
                                <td>F55118213</td>
                                <td>Teknik Informatika</td>
                                <td>CV Lumintu Logic</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>AKWAN MAROSO</td>
                                <td>F55119044</td>
                                <td>Teknik Informatika</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>Ryan Adi Putra</td>
                                <td>F55119059</td>
                                <td>Teknik Informatika</td>
                                <td>PT Global Intra Talenta</td>
                                <td>Magang</td>
                            </tr>
                            <tr>
                                <td>Andi Gita Magfira Pratiwi Putri</td>
                                <td>F55119083</td>
                                <td>Teknik Informatika</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FAHUT -->
                <div class="tab-pane fade" id="fahut" role="tabpanel">
                    <table id="fahut-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>INUL MUAFFAT</td>
                                <td>L13118039</td>
                                <td>Kehutanan</td>
                                <td>PT Berau Coal</td>
                                <td>Magang</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FAPETKAN -->
                <div class="tab-pane fade" id="fapetkan" role="tabpanel">
                    <table id="fapetkan-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NIM</th>
                                <th>Nama</th>
                                <th>Program Studi</th>
                                <th>Mitra</th>
                            </tr>
                        </thead>
                        <tbody>
                           
                        </tbody>
                    </table>
                </div>

                <!-- FKM -->
                <div class="tab-pane fade" id="fkm" role="tabpanel">
                    <table id="fkm-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nama </th>
                                <th>NIM</th>
                                <th>Prodi</th>
                                <th>Mitra</th>
                                <th>Jenis Program</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CHAERUN NISA TAMSIL</td>
                                <td>P10118095</td>
                                <td>Kesehatan Masyarakat</td>
                                <td>PT. Microsoft Indonesia</td>
                                <td>Studi Independen</td>
                            </tr>
                            <tr>
                                <td>ARINY POESPITASARI</td>
                                <td>P21118053</td>
                                <td>Gizi</td>
                                <td>Yayasan Sekolah Ekspor Nasional</td>
                                <td>Studi Independen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>

    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    $(document).ready(function() {
        // Apply DataTables to all tables
        $('table').DataTable();
    });
</script>
<script>
    // Function to download table data as Excel
    function downloadTableAsExcel(tableID) {
        // Get DataTable instance using the table ID
        var table = $('#' + tableID).DataTable();  // Correctly refer to tableID
        if (table.data().length === 0) {
            alert("Tabel kosong, tidak ada data untuk diunduh.");
            return;  // Stop execution if table is empty
        }
        var data = [];

        // Get table headers
        var headers = [];
        $('#' + tableID + ' thead th').each(function () {
            headers.push($(this).text());
        });
        data.push(headers);  // Add headers to the data array

        // Get all table data (including non-visible rows due to pagination)
        table.rows().every(function () {
            var rowData = this.data();
            data.push(rowData);  // Add row data to the data array
        });

        // Create new workbook and worksheet
        var workbook = XLSX.utils.book_new();
        var worksheet = XLSX.utils.aoa_to_sheet(data);  // Create worksheet from array of arrays (aoa)

        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

        // Export workbook to XLSX file and trigger download
        XLSX.writeFile(workbook, 'Data Peserta MBKM.xlsx');
    }

    // Function to get the active tab and download the corresponding table
    document.getElementById("download-btn").addEventListener("click", function () {
        const activeTab = document.querySelector(".tab-pane.active");

        if (activeTab) {
            // Find the table inside the active tab
            const table = activeTab.querySelector("table");
            if (table) {
                const tableID = table.getAttribute("id");
                downloadTableAsExcel(tableID);
            } else {
                alert("Tidak ada tabel di tab yang aktif.");
            }
        } else {
            alert("Tidak ada tab yang aktif.");
        }
    });
</script>

</body>
</html>
